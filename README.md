# User Interface

Users can see the following notifications in Teams Channel.

![Message UI](/images/message_ui.jpg =700x)

- The title is generated by GPT4.
- The second line shows the UTC time of the update.
- The body contains a summary of the updates made to different documents by GPT4. For example, in the example provided, three documents were updated.
- Clicking on the link takes you to the official documentation.
- The "Go to commit page" button at the bottom takes you to the commit page on GitHub.

# Commit Page

https://github.com/MicrosoftDocs/azure-docs/commit/4189b431df9d28d94f54661e223c318335bcb9f2

You can see that this update involves modifications to three files, which is consistent with the summary provided by GPT4.
The left side shows the version before the update, and the right side shows the version after the update.

![Commit Page](/images/commit_page.jpg =1000x)

By clicking on the Preview button in the upper right corner, you can see the updated content more intuitively.

https://github.com/MicrosoftDocs/azure-docs/commit/4189b431df9d28d94f54661e223c318335bcb9f2

![preview_button](/images/preview_button.jpg =1000x)

![preview_ui](/images/preview_ui.jpg =1000x)

# Implementation :

- Taking Azure OpenAI Documents as an example, each update to the documentation is recorded on this page: https://github.com/MicrosoftDocs/azure-docs/commits/main/articles/ai-services/openai.
- We can get the history
- Crawl the update content of each commit.
- Submit the update content to GPT4 for summarization and generate a title.
- Push the summary generated by GPT4 to Teams Channel through the Teams Channel Webhook.
- The program checks for new commits every hour.

# Running Configuration

1. pip install -r requirements.txt
2. Create a copy of .env.example, rename it to .env
   - [Link your GitHub and Microsoft accounts](https://review.learn.microsoft.com/en-us/help/get-started/setup-github?branch=main&branchFallbackFrom=master#2-link-your-github-and-microsoft-accounts)
   - [generate github access token](https://docs.github.com/en/enterprise-server@3.6/authentication/keeping-your-account-and-data-secure/managing-your-personal-access-tokens)
   - [Authorizing a personal access token for use with SAML single sign-on](https://docs.github.com/en/enterprise-cloud@latest/authentication/authenticating-with-saml-single-sign-on/authorizing-a-personal-access-token-for-use-with-saml-single-sign-on)
     ![SSO](/images/SSO.png =1000x)
   - [create Azure OpenAI resource. Please use GPT-4!](https://learn.microsoft.com/en-us/azure/ai-services/openai/how-to/create-resource?pivots=web-portal)
   - [create cosmosdb account, database, container, and get the key.](https://learn.microsoft.com/en-us/azure/cosmos-db/nosql/quickstart-portal)
3. Create a copy of last_crawl_time.txt.example, rename it to last_crawl_time.txt

   - For the initial setup, the bot will only process changes after the specified timestamp(UTC+0).
   - If the file is not manually created, the bot will create a new one and put current time into it.
   - [related code.](https://dev.azure.com/GCR-AI-IoT-Team-Operation/_git/DocUpdateNotificationBot?path=/app.py&version=GBmaster&line=110&lineEnd=135&lineStartColumn=1&lineEndColumn=60&lineStyle=plain&_a=contents)
4. Create a copy of target_config.json.example, rename it to target_config.json
5. cd /home/user/DocUpdateNotificationBot
6. nohup python3 app.py &
7. tail -f ./logs/log.txt -n 20

# How to get root_commits_url used in target_config.json?

![root_commits_url](/images/root_commits_url.jpg =1000x)

### Switch to Rest API URL:

   /main/        =>   ?path=
github.com   =>   api.github.com/repos

For example:
https://   ~~github.com~~   /MicrosoftDocs/azure-docs/commits   ~~/main/~~   articles/ai-services/openai/
=>
https://   **api.github.com/repos**   /MicrosoftDocs/azure-docs/commits   **?path=**   articles/ai-services/openai

# How to create Teams Channel Webhook

https://learn.microsoft.com/en-us/microsoftteams/platform/webhooks-and-connectors/how-to/add-incoming-webhook?tabs=dotnet

# Set url_mapping in target_config.json
![url_mapping](/images/url_mapping.png =1000x)

# Architecture

![flow](/image/README/flow.png =1000x)
![arc](/image/README/arc.png =1000x)

# ä¸­æ–‡ä»‹ç»ï¼ˆæœªåŠæ—¶æ›´æ–°ï¼Œè¯·ä»¥è‹±æ–‡ç‰ˆä¸ºå‡†ğŸ˜„ï¼‰

æ•™å­¦è§†é¢‘
[å½•å±ç¬¬ä¸€æ®µ](https://microsoftapc-my.sharepoint.com/:v:/g/personal/zehua_microsoft_com/EUGH-FF3AolDgZt4tx99XqgBGiWEdpHHjQgNCETh71C3xg?e=2qIg4j&nav=eyJyZWZlcnJhbEluZm8iOnsicmVmZXJyYWxBcHAiOiJTdHJlYW1XZWJBcHAiLCJyZWZlcnJhbFZpZXciOiJTaGFyZURpYWxvZy1MaW5rIiwicmVmZXJyYWxBcHBQbGF0Zm9ybSI6IldlYiIsInJlZmVycmFsTW9kZSI6InZpZXcifX0%3D)
[å½•å±ç¬¬äºŒæ®µ](https://microsoftapc-my.sharepoint.com/:v:/g/personal/zehua_microsoft_com/EXJocHoLdMpNtqzOeyn4yEwBUlgDRSOUKPyZmFHasAOgDg?e=VB9siS&nav=eyJyZWZlcnJhbEluZm8iOnsicmVmZXJyYWxBcHAiOiJTdHJlYW1XZWJBcHAiLCJyZWZlcnJhbFZpZXciOiJTaGFyZURpYWxvZy1MaW5rIiwicmVmZXJyYWxBcHBQbGF0Zm9ybSI6IldlYiIsInJlZmVycmFsTW9kZSI6InZpZXcifX0%3D)

# ç”¨æˆ·ç•Œé¢

ç”¨æˆ·å¯ä»¥åœ¨Teams Channelä¸­çœ‹åˆ°ä»¥ä¸‹æ¨é€ã€‚

![Message UI](/images/message_ui_Chinese.jpg =1000x)

- æœ€ä¸Šæ–¹æ˜¯GPT4ç»™å‡ºçš„æ ‡é¢˜
- ç¬¬äºŒè¡Œæ˜¯æ›´æ–°çš„UTCæ—¶é—´
- ä¸»ä½“å†…å®¹æ˜¯GPT4å¯¹è¿™æ¬¡æ›´æ–°æ¶‰åŠåˆ°çš„ä¸åŒæ–‡æ¡£çš„æ€»ç»“ã€‚æ¯”å¦‚ä¾‹å­ä¸­æ¶‰åŠäº†ä¸‰ä¸ªæ–‡æ¡£çš„æ›´æ–°ã€‚
- ç‚¹å‡»é“¾æ¥å¯ä»¥è¿›å…¥å®˜æ–¹æ–‡æ¡£ã€‚
- æœ€ä¸‹æ–¹çš„â€œGo to commit pageâ€æŒ‰é’®ï¼Œå¯ä»¥è·³è½¬åˆ°GitHubçš„commité¡µé¢ã€‚

# Commit Page

https://github.com/MicrosoftDocs/azure-docs/commit/4189b431df9d28d94f54661e223c318335bcb9f2

å¯ä»¥çœ‹åˆ°è¿™æ¬¡æ›´æ–°æ¶‰åŠäº†ä¸‰ä¸ªæ–‡ä»¶çš„ä¿®æ”¹ï¼Œå’ŒGPT4ç»™å‡ºçš„æ€»ç»“ä¸€è‡´ã€‚
å·¦è¾¹æ˜¯æ›´æ–°å‰çš„ç‰ˆæœ¬ï¼Œå³è¾¹æ˜¯æ›´æ–°åçš„ç‰ˆæœ¬ã€‚

![Commit Page](/images/commit_page.jpg =1000x)

é€šè¿‡ç‚¹å‡»å³ä¸Šè§’çš„PreviewæŒ‰é’®ï¼Œå¯ä»¥æ›´ç›´è§‚åœ°çœ‹åˆ°æ›´æ–°çš„å†…å®¹ã€‚
https://github.com/MicrosoftDocs/azure-docs/commit/4189b431df9d28d94f54661e223c318335bcb9f2

![preview_button](/images/preview_button.jpg =1000x)

![preview_ui](/images/preview_ui.jpg =1000x)

# åŸç†ï¼š

- ä»¥Azure OpenAIä¸ºä¾‹ï¼Œæ–‡æ¡£çš„æ¯æ¬¡æ›´æ–°è®°å½•éƒ½ä¼šè®°å½•åœ¨ https://github.com/MicrosoftDocs/azure-docs/commits/main/articles/ai-services/openai è¿™ä¸ªé¡µé¢ã€‚
- çˆ¬å–æ¯ä¸€ä¸ªcommitçš„æ›´æ–°å†…å®¹
- æäº¤ç»™GPT4è¿›è¡Œæ€»ç»“ï¼Œç”Ÿæˆæ ‡é¢˜
- é€šè¿‡Teams Channel Webhookå°†GPT4çš„æ€»ç»“æ¨é€åˆ°Teams Channel
- ç¨‹åºæ¯å°æ—¶ä¼šå»æŸ¥è¯¢æ˜¯å¦æœ‰æ–°çš„commitsç”Ÿæˆ

# è¿è¡Œé…ç½®

1. pip install -r requirements
2. æŒ‰ç…§.env.exampleçš„ç¤ºä¾‹åˆ›å»º.envæ–‡ä»¶
3. æŒ‰ç…§last_crawl_time.txt.exampleçš„ç¤ºä¾‹åˆ›å»ºlast_crawl_time.txt
4. æŒ‰ç…§target_config.json.exampleçš„ç¤ºä¾‹åˆ›å»ºtarget_config.jsonæ–‡ä»¶

# How to create Teams Channel Webhook

https://learn.microsoft.com/en-us/microsoftteams/platform/webhooks-and-connectors/how-to/add-incoming-webhook?tabs=dotnet
